import reimport requestsimport csvimport time"""翻页爬取豆瓣电影并保存在csv文件中"""# 创建一个csv文件用于保存数据f = open('douban_fild.csv', mode='w')csv_writer = csv.writer(f)headers = {    "user-agent": "Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) "                  "Chrome/98.0.4758.80 Mobile Safari/537.36 "}# 编写正则表达式匹配想要的数据，电影名称，年份，评分，评价人数obj = re.compile(r'<li>.*? </div>.*?<span class="title">(?P<film_name>.*?)'                 r'</span>.*? </div>.*?<br>(?P<year>.*?)'                 r'&nbsp;/&nbsp.*?<span class="rating_num" property="v:average">(?P<rating>.*?)'                 r'</span>.*?<span>(?P<rate_nums>.*?)人评价</span>', re.S)# 拿到页面源代码，通多re来提起想要的有效信息lis = [0, 50, 75]for j in range(len(lis)):  # 0 1 2    url = "https://movie.douban.com/top250?start=%s&filter=" % lis[j]  # 翻页    resp = requests.get(url, headers=headers)    # 这是网页的源代码    html_context = resp.text    time.sleep(5)    # 解析后的结果储存在迭代器中    res = obj.finditer(html_context)    for i in res:        dic = i.groupdict()  # dic={'film_name': '肖申克的救赎', 'year': '\n  1994', 'rating': '9.7', 'rate_nums': '2561826'}        dic['year'] = dic['year'].strip()  # 去除年份前的空行        csv_writer.writerow(dic.values())    print("第%s页结束" % j + 1)f.close()resp.close()